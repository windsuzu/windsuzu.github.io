<!doctype html>
<html lang="zh-TW" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-frontend/react-next/error-boundary-guide">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">ErrorBoundary Guide | Jay&#x27;s Domain</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://windsuzu.github.io/img/logo/og-image.png"><meta data-rh="true" name="twitter:image" content="https://windsuzu.github.io/img/logo/og-image.png"><meta data-rh="true" property="og:url" content="https://windsuzu.github.io/frontend/react-next/error-boundary-guide"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ErrorBoundary Guide | Jay&#x27;s Domain"><meta data-rh="true" name="description" content="åœ¨ React ä¸­ï¼Œæˆ‘å€‘ç„¡æ³•å°‡æ•´å€‹ useEffect æˆ–å­å…ƒç´ è£åœ¨ try/catch ä¾†æ•ç²éŒ¯èª¤ï¼Œä½†æˆ‘å€‘å¯ä»¥ä½¿ç”¨ ErrorBoundary ä¾†å¯¦ç¾é€™ä¸€é»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒErrorBoundary ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚ç„¡æ³•æ•ç²éåŒæ­¥éŒ¯èª¤æˆ–äº‹ä»¶è™•ç†ä¸­çš„éŒ¯èª¤ã€‚ä½†æˆ‘å€‘å¯ä»¥åœ¨ catch å€å¡Šä¸­å¼·åˆ¶å°‡ React é‡æ–°æ¸²æŸ“ï¼Œç„¶å¾ŒæŠŠéŒ¯èª¤ä¸Ÿå›é‡æ–°æ¸²æŸ“çš„ç”Ÿå‘½é€±æœŸä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚"><meta data-rh="true" property="og:description" content="åœ¨ React ä¸­ï¼Œæˆ‘å€‘ç„¡æ³•å°‡æ•´å€‹ useEffect æˆ–å­å…ƒç´ è£åœ¨ try/catch ä¾†æ•ç²éŒ¯èª¤ï¼Œä½†æˆ‘å€‘å¯ä»¥ä½¿ç”¨ ErrorBoundary ä¾†å¯¦ç¾é€™ä¸€é»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒErrorBoundary ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚ç„¡æ³•æ•ç²éåŒæ­¥éŒ¯èª¤æˆ–äº‹ä»¶è™•ç†ä¸­çš„éŒ¯èª¤ã€‚ä½†æˆ‘å€‘å¯ä»¥åœ¨ catch å€å¡Šä¸­å¼·åˆ¶å°‡ React é‡æ–°æ¸²æŸ“ï¼Œç„¶å¾ŒæŠŠéŒ¯èª¤ä¸Ÿå›é‡æ–°æ¸²æŸ“çš„ç”Ÿå‘½é€±æœŸä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://windsuzu.github.io/frontend/react-next/error-boundary-guide"><link data-rh="true" rel="alternate" href="https://windsuzu.github.io/frontend/react-next/error-boundary-guide" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://windsuzu.github.io/frontend/react-next/error-boundary-guide" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jay&#39;s Domain RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jay&#39;s Domain Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d896e9d5.css">
<link rel="preload" href="/assets/js/runtime~main.0c6ee512.js" as="script">
<link rel="preload" href="/assets/js/main.6782d141.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="è·³è‡³ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">è·³è‡³ä¸»è¦å†…å®¹</a></div><nav aria-label="ä¸»å°èˆª" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/icon/icon.svg" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon/icon-dark.svg" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Jay&#x27;s Domain</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">é–±è®€å‰ç«¯</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/frontend/html-css/intro">HTML / CSS</a></li><li><a class="dropdown__link" href="/frontend/js-ts/intro">JavaScript / TypeScript</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/frontend/react-next/intro">React / Next</a></li><li><a class="dropdown__link" href="/frontend/other/intro">Other</a></li></ul></div><a class="navbar__item navbar__link" href="/learning/intro">å­¸ç¿’ç­†è¨˜</a><a class="navbar__item navbar__link" href="/blog">éƒ¨è½æ ¼</a></div><div class="navbar__items navbar__items--right"><a href="https://www.github.com/windsuzu/windsuzu.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ›æ·ºè‰²/æš—é»‘æ¨¡å¼ï¼ˆç•¶å‰ç‚ºæ·ºè‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ›æ·ºè‰²/æš—é»‘æ¨¡å¼ï¼ˆç•¶å‰ç‚ºæ·ºè‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="å›åˆ°é ‚éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/icon/icon.svg" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/icon/icon-dark.svg" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>Jay&#x27;s Domain</b></a><nav aria-label="æ–‡ä»¶å´é‚Šæ¬„" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/intro">ğŸ“¢ README</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/usestate-vs-usesignal">ğŸŸ¨ useState vs useSignal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/frontend/react-next/error-boundary-guide">ğŸŸ© ErrorBoundary Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/is-usestate-asynchronous">ğŸŸ© Is useState Asynchronous?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/components-map">ğŸŸ© Components Map</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/react-folder-structure">ğŸŸ© React Folder Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/keeping-state-local">ğŸŸ© Keeping State Local</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/use-imperative-handle">ğŸŸ© useImperativeHandle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/state-in-urlsearchparams">ğŸŸ¨ State in URLSearchParams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/react-scroll-animations">ğŸŸ© React Scroll Animations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/frontend/react-next/function-composition">ğŸŸ© Function Composition</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é é¢è·¯å¾‘"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é é¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ğŸŸ© ErrorBoundary Guide</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é å°è¦½</button></div><div class="theme-doc-markdown markdown"><div style="display:flex;flex-direction:column;place-items:start;text-align:start;padding:0 0 2rem 0"><a href="https://www.developerway.com/posts/how-to-handle-errors-in-react" target="_blank" rel="noreferrer" class="gradient-text_Bqxt">How to handle errors in React: full guide</a><p style="font-weight:600;margin:0;color:gray;font-family:monospace"><span style="font-size:1rem">from</span>  <span style="font-size:1.5rem">NADIA MAKAREVICH</span></p><div style="padding:0.6rem 0;display:flex;flex-wrap:wrap;gap:12px"><div style="user-select:none;padding:0.2rem 0.5rem;background:#8b9862;font-weight:700;color:white;font-family:Archivo Black, sans-serif;letter-spacing:0.05rem">Beginner</div><p style="margin:0;font-weight:900;font-size:19px;vertical-align:middle">/</p><div style="display:flex;flex-wrap:wrap;gap:0.2rem"><div style="user-select:none;padding:0.2rem 0.5rem;background:#476098;font-weight:700;color:white;font-family:Archivo Black, sans-serif;letter-spacing:0.05rem">React / Next</div><div style="user-select:none;padding:0.2rem 0.5rem;background:#89632a;font-weight:700;color:white;font-family:Archivo Black, sans-serif;letter-spacing:0.05rem">JavaScript / TypeScript</div></div></div></div><p>æœ¬æ–‡ä»‹ç´¹äº† React ä¸­è™•ç†éŒ¯èª¤çš„å…©ç¨®æ–¹å¼ï¼šä½¿ç”¨ <code>try/catch</code> å’Œ <code>ErrorBoundary</code>ï¼Œä»¥åŠå®ƒå€‘å„è‡ªçš„é™åˆ¶ã€‚ä½¿ç”¨ <code>try/catch</code> æ™‚ï¼Œå®ƒç„¡æ³•æ•ç² <code>hooks</code> å’Œå­çµ„ä»¶ä¸­çš„éŒ¯èª¤ã€‚ä½¿ç”¨ <code>ErrorBoundary</code> æ™‚ï¼Œå®ƒç„¡æ³•æ•ç²<strong>ç•°æ­¥ä»£ç¢¼ (async code)</strong> å’Œ<strong>äº‹ä»¶è™•ç†ç¨‹åº (event handler)</strong> ä¸­çš„éŒ¯èª¤ã€‚ä½†æ˜¯ï¼Œå¯ä»¥é€šéåœ¨ <code>try/catch</code> ä¸­æ•ç²éŒ¯èª¤ï¼Œç„¶å¾Œå°‡éŒ¯èª¤é‡æ–°æŠ›å‡ºåˆ° React çš„ç”Ÿå‘½é€±æœŸä¸­ï¼Œä½¿ <code>ErrorBoundary</code> èƒ½å¤ æ•ç²é€™äº›éŒ¯èª¤ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="why-do-we-need-to-catch-errors-in-react">Why do we need to catch errors in React?<a href="#why-do-we-need-to-catch-errors-in-react" class="hash-link" aria-label="Why do we need to catch errors in React?çš„ç›´æ¥é€£çµ" title="Why do we need to catch errors in React?çš„ç›´æ¥é€£çµ">â€‹</a></h2><p>ç‚ºä»€éº¼æˆ‘å€‘éœ€è¦åœ¨ React ä¸­æ•ç²éŒ¯èª¤å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å› ç‚ºå¾ React 16 é–‹å§‹ï¼Œå¦‚æœæ²’æœ‰æ•ç²éŒ¯èª¤ï¼ŒReact æœƒç›´æ¥åœ¨ç”Ÿå‘½é€±æœŸä¸­æŠ›å‡ºéŒ¯èª¤ï¼Œåœæ­¢æ•´å€‹æ‡‰ç”¨ç¨‹åºï¼Œä¸¦è·³å‡ºéŒ¯èª¤é é¢ã€‚å› æ­¤ï¼Œå³ä½¿éŒ¯èª¤ç™¼ç”Ÿåœ¨ UI ä¸­çš„æŸå€‹ä¸é‡è¦çš„éƒ¨åˆ†ï¼Œæˆ–è€…æ˜¯æŸå€‹ä½ ç„¡æ³•æ§åˆ¶çš„ç¬¬ä¸‰æ–¹åº«ä¸­ï¼Œå¦‚æœæ²’æœ‰æ•ç²éŒ¯èª¤ï¼Œæ•´å€‹é é¢éƒ½æœƒè¢«éŠ·æ¯€ï¼Œä¸¦ä¸”å‘ä½¿ç”¨è€…é¡¯ç¤ºéŒ¯èª¤é é¢ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="review-catching-errors-in-javascript">Review: Catching Errors in JavaScript<a href="#review-catching-errors-in-javascript" class="hash-link" aria-label="Review: Catching Errors in JavaScriptçš„ç›´æ¥é€£çµ" title="Review: Catching Errors in JavaScriptçš„ç›´æ¥é€£çµ">â€‹</a></h2><p>åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>try/catch</code> ä¾†æ•ç²éŒ¯èª¤ã€‚å¦‚æœåœ¨ <code>try</code> ä¸­çš„ä»£ç¢¼ä¸­ç™¼ç”ŸéŒ¯èª¤ï¼Œå‰‡å¯ä»¥æ•ç²éŒ¯èª¤ï¼Œä¸¦åœ¨ <code>catch</code> ä¸­è™•ç†éŒ¯èª¤ã€‚é€™å€‹æ–¹æ³•é©ç”¨æ–¼åŒæ­¥ç¨‹å¼ç¢¼ï¼Œä¹Ÿé©ç”¨æ–¼éåŒæ­¥ç¨‹å¼ç¢¼ã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Promise.then()</code> å’Œ <code>Promise.catch()</code> ä¾†æ•ç²éåŒæ­¥çš„éŒ¯èª¤ï¼Œä½†é€™ç¯‡æ–‡ç« ä»¥ <code>try/catch</code> ç‚ºä¸»ã€‚</p><div style="columns:20rem"><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Catch synchronous errors</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">doSomethingWrong</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// handle error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Catch asynchronous errors</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/bla-bla&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// handle error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="problems-of-trycatch-in-react">Problems of <code>try/catch</code> in React<a href="#problems-of-trycatch-in-react" class="hash-link" aria-label="problems-of-trycatch-in-reactçš„ç›´æ¥é€£çµ" title="problems-of-trycatch-in-reactçš„ç›´æ¥é€£çµ">â€‹</a></h2><p>åœ¨ React ä¸­ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>try/catch</code> ä¾†æ•ç²éŒ¯èª¤ã€‚ä½†æ˜¯ï¼Œä»¥ä¸‹æ˜¯ä¸‰ç¨®éŒ¯èª¤çš„ä½¿ç”¨æ–¹å¼ï¼š</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-catch-errors-in-useeffect">1. Catch errors in <code>useEffect</code><a href="#1-catch-errors-in-useeffect" class="hash-link" aria-label="1-catch-errors-in-useeffectçš„ç›´æ¥é€£çµ" title="1-catch-errors-in-useeffectçš„ç›´æ¥é€£çµ">â€‹</a></h3><p>å°‡ <code>useEffect</code> æ•´å€‹æ”¾åœ¨ <code>try/catch</code> ä¸­æ˜¯éŒ¯èª¤çš„ã€‚ç”±æ–¼ <code>useEffect</code> æ˜¯åœ¨ render å¾ŒéåŒæ­¥åŸ·è¡Œï¼Œæ‰€ä»¥å°æ–¼ <code>try/catch</code> ä¾†èªªæ°¸é éƒ½æ˜¯æˆåŠŸåŸ·è¡Œï¼Œä¹Ÿå°±æ°¸é æŠ“ä¸åˆ° <code>useEffect</code> ä¸­çš„éŒ¯èª¤ã€‚</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Catch errors in hooks âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Component</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">doSomethingWrong</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// never triggered</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">div </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-catch-errors-in-children">2. Catch errors in <code>children</code><a href="#2-catch-errors-in-children" class="hash-link" aria-label="2-catch-errors-in-childrençš„ç›´æ¥é€£çµ" title="2-catch-errors-in-childrençš„ç›´æ¥é€£çµ">â€‹</a></h3><p>å°‡ <code>children</code> æ•´å€‹æ”¾åœ¨ <code>try/catch</code> ä¸­æ˜¯éŒ¯èª¤çš„ã€‚ä¸ç®¡æ˜¯åœ¨ <code>try/catch</code> ä¸­å®šç¾© <code>children</code>ï¼Œé‚„æ˜¯ç›´æ¥åœ¨ <code>try/catch</code> ä¸­è¿”å› <code>children</code>ï¼Œéƒ½æ˜¯éŒ¯èª¤çš„ã€‚é€™æ˜¯å› ç‚ºç•¶ç¨‹å¼åŸ·è¡Œåˆ° <code>&lt;Child /&gt;</code> æ™‚ï¼Œå®ƒä¸¦ä¸æ˜¯çœŸæ­£çš„æ¸²æŸ“å…ƒä»¶ï¼Œè€Œæ˜¯å‰µå»ºäº†ä¸€å€‹å…ƒä»¶å…ƒç´ ã€‚é€™å€‹å…ƒç´ åªæ˜¯ä¸€å€‹åŒ…å«å…ƒä»¶é¡å‹å’Œå±¬æ€§çš„å°è±¡ï¼Œè€Œä¸”æœƒåœ¨ <code>try/catch</code> åŸ·è¡ŒæˆåŠŸå¾Œï¼Œåœ¨ React ä¸­è¢«ä½¿ç”¨ï¼Œèˆ‡ <code>useEffect</code> çš„æƒ…æ³é¡ä¼¼ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ç„¡æ³•æ•ç²éŒ¯èª¤çš„ã€‚</p><div style="columns:20rem"><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Catch errors in children âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Component</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> child</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Child</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// never triggered</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> child</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Catch errors in children âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Component</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Child</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// never triggered</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-catch-errors-in-render-and-change-state">3. Catch errors in <code>render</code> and Change state<a href="#3-catch-errors-in-render-and-change-state" class="hash-link" aria-label="3-catch-errors-in-render-and-change-stateçš„ç›´æ¥é€£çµ" title="3-catch-errors-in-render-and-change-stateçš„ç›´æ¥é€£çµ">â€‹</a></h3><p>åœ¨ <code>render</code> ä¸­ä½¿ç”¨ <code>try/catch</code> ä¾†æ•ç²éŒ¯èª¤ï¼Œä¸¦åœ¨ <code>catch</code> ä¸­æ”¹è®Š <code>state</code>ï¼Œé€™æ˜¯éŒ¯èª¤çš„ã€‚é€™æ˜¯å› ç‚º <code>render</code> æ˜¯åŒæ­¥åŸ·è¡Œçš„ï¼Œæ‰€ä»¥ <code>try/catch</code> æœƒæ•ç²åˆ°éŒ¯èª¤ï¼Œä½†æ˜¯åœ¨ <code>catch</code> ä¸­æ”¹è®Š <code>state</code> æœƒå°è‡´ç„¡é™å¾ªç’°ï¼Œå› ç‚º <code>render</code> æœƒå†æ¬¡è¢«èª¿ç”¨ï¼Œé€²è€Œå†æ¬¡è§¸ç™¼ <code>try/catch</code>ã€‚</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Change state in render âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Component</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">hasError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setHasError</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">doSomethingComplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// will cause infinite loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setHasError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="errorboundary-in-react">ErrorBoundary in React<a href="#errorboundary-in-react" class="hash-link" aria-label="ErrorBoundary in Reactçš„ç›´æ¥é€£çµ" title="ErrorBoundary in Reactçš„ç›´æ¥é€£çµ">â€‹</a></h2><p>ç‚ºäº†è§£æ±ºä¸Šè¿°å•é¡Œï¼ŒReact æä¾›äº† <code>ErrorBoundary</code> é€™å€‹<strong>ã€Œæ¦‚å¿µã€</strong> ä¾†æ•ç²éŒ¯èª¤ã€‚æˆ‘å€‘å¿…é ˆä½¿ç”¨èˆŠç‰ˆçš„ class component è‡ªè¡Œå¯¦ç¾ä¸€å€‹ <code>ErrorBoundary</code>ï¼Œç„¶å¾Œä½¿ç”¨å®ƒä¾†åŒ…ä½å¯èƒ½æœƒç™¼ç”ŸéŒ¯èª¤çš„å…ƒä»¶ã€‚é€™å€‹ <code>ErrorBoundary</code> å…ƒä»¶åŒ…å«äº†å¹¾å€‹ç”Ÿå‘½é€±æœŸæ–¹æ³•ï¼Œä¾‹å¦‚</p><ul><li><code>constructor</code> æœƒåˆå§‹åŒ–ä¸€å€‹ <code>state</code>ï¼Œç”¨ä¾†å­˜æ”¾æ˜¯å¦ç™¼ç”ŸéŒ¯èª¤</li><li><code>static getDerivedStateFromError</code> æœƒåœ¨ <code>render</code> ä¸­ç™¼ç”ŸéŒ¯èª¤æ™‚è¢«èª¿ç”¨ï¼Œä¸¦å°‡ <code>state</code> ä¸­çš„ <code>hasError</code> è¨­ç½®ç‚º <code>true</code>ï¼Œæˆ‘å€‘å°±å¯ä»¥æ ¹æ“š <code>hasError</code> ä¾†æ¸²æŸ“éŒ¯èª¤è¨Šæ¯ã€‚é€™å€‹æ–¹æ³•æ˜¯ç”¢ç”Ÿ ErrorBoundary çš„å¿…è¦æ–¹æ³•</li><li><code>componentDidCatch</code> å¯ä»¥å°‡éŒ¯èª¤è¨Šæ¯åŠ ä»¥åˆ©ç”¨ï¼Œä¾‹å¦‚ç™¼é€åˆ°å¾Œç«¯ï¼Œæˆ–è€…ä½¿ç”¨ <code>Sentry</code> ä¾†æ•ç²éŒ¯èª¤</li></ul><p>å¦å¤–ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥è‡ªå®šç¾© <code>ErrorBoundary</code> çš„ <code>fallback</code>ï¼Œé€™å€‹ <code>fallback</code> æœƒåœ¨ <code>render</code> ä¸­ç™¼ç”ŸéŒ¯èª¤æ™‚è¢«æ¸²æŸ“ã€‚</p><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">å³æ™‚ç·¨è¼¯å™¨</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    // initialize the error state
    this.state = { hasError: false };
  }

  // if an error happened, set the state to true
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }

  componentDidCatch(error, errorInfo) {
    // send error to somewhere here
    console.log(error, errorInfo);
  }

  render() {
    // if error happened, return a fallback component
    if (this.state.hasError) {
      return this.props.fallback || &lt;&gt;Oh no! Something went wrong!&lt;/&gt;;
    }

    return this.props.children;
  }
}

const ErrorComponent = () =&gt; {
  const [counter, setCounter] = useState(0);

  useEffect(() =&gt; {
    if (counter &gt; 0) throw new Error(&quot;error&quot;);
  }, [counter]);

  return (
    &lt;button onClick={() =&gt; setCounter((prev) =&gt; prev + 1)}&gt;Click me&lt;/button&gt;
  );
};

render(
  &lt;ErrorBoundary fallback={&lt;&gt;Wow it is broken!&lt;/&gt;}&gt;
    &lt;ErrorComponent /&gt;
  &lt;/ErrorBoundary&gt;
);</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ErrorBoundary</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// initialize the error state</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// if an error happened, set the state to true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDerivedStateFromError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">componentDidCatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> errorInfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// send error to somewhere here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> errorInfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// if error happened, return a fallback component</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hasError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fallback</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Oh no! Something went wrong!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">ErrorComponent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setCounter</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;error&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript function" style="color:#d73a49">setCounter</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript parameter" style="color:#00009f">prev</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token tag script language-javascript" style="color:#00009f"> prev </span><span class="token tag script language-javascript operator" style="color:#393A34">+</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript number" style="color:#36acaa">1</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Click me</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">fallback</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript plain-text" style="color:#00009f">Wow it is broken!</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorComponent</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div><div class="playgroundHeader_dyrN">çµæœ</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="errorboundary-with-asynchronous-error">ErrorBoundary with Asynchronous Error<a href="#errorboundary-with-asynchronous-error" class="hash-link" aria-label="ErrorBoundary with Asynchronous Errorçš„ç›´æ¥é€£çµ" title="ErrorBoundary with Asynchronous Errorçš„ç›´æ¥é€£çµ">â€‹</a></h2><p>ä¸Šé¢æˆ‘å€‘æ‰€å¯«çš„ <code>ErrorBoundary</code> æœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚æˆ‘å€‘ä¸èƒ½é€é <code>ErrorBoundary</code> ä¾†æ•ç²éåŒæ­¥çš„éŒ¯èª¤ï¼Œä¾‹å¦‚ <code>setTimeout</code>ã€<code>Promise</code>ï¼›æˆ‘å€‘ä¹Ÿç„¡æ³•é€é <code>ErrorBoundary</code> ä¾†æ•ç² Event Handler, Callback ä¸­çš„éŒ¯èª¤ï¼Œä¾‹å¦‚ <code>onClick</code>ã€<code>onSubmit</code>ã€‚</p><div style="columns:20rem"><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">can&#x27;t catch errors from event handler âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onClick</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// this error will disappear into the void</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hulk smash!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">can&#x27;t catch errors from async function âŒ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//the error will also disappear</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/bla&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="è¤‡è£½ä»£ç¢¼è‡³å‰ªè²¼ç°¿" title="è¤‡è£½" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><p>ä¸éåœ¨ <a href="https://github.com/facebook/react/issues/14981#issuecomment-468460187" target="_blank" rel="noopener noreferrer">Throwing Error from hook not caught in error boundary Â· Issue #14981 Â· facebook/react</a>. ä¸­ï¼Œ<a href="https://twitter.com/dan_abramov" target="_blank" rel="noopener noreferrer">Dan Abramov</a> æä¾›äº†ä¸€å€‹è§£æ±ºæ–¹æ¡ˆã€‚æˆ‘å€‘å¯ä»¥å…ˆåœ¨ <code>try/catch</code> ä¸­æ•ç²éŒ¯èª¤ï¼Œç„¶å¾Œåœ¨ <code>catch</code> ä¸­è§¸ç™¼ä¸€æ¬¡ React é‡æ–°æ¸²æŸ“ï¼Œæœ€å¾Œå†å°‡éŒ¯èª¤ä¸Ÿå›é‡æ–°æ¸²æŸ“çš„ç”Ÿå‘½é€±æœŸä¸­ã€‚é€™æ¨£ <code>ErrorBoundary</code> å°±å¯ä»¥åƒå…¶ä»–éŒ¯èª¤ä¸€æ¨£æ•ç²å®ƒå€‘ã€‚ç”±æ–¼ <code>useState</code> çš„æ›´æ–°æ˜¯è§¸ç™¼é‡æ–°æ¸²æŸ“çš„æ–¹å¼ï¼Œè€Œ <code>useState</code> çš„è¨­ç½®å‡½æ•¸å¯ä»¥æ¥å—ä¸€å€‹æ›´æ–°å‡½æ•¸ä½œç‚ºåƒæ•¸ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ä½¿ç”¨é€™å€‹æ›´æ–°å‡½æ•¸ä¾†é‡æ–°ä¸Ÿå‡ºéŒ¯èª¤ã€‚</p><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">å³æ™‚ç·¨è¼¯å™¨</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">// this is a custom hook to throw error in async function
const useThrowAsyncError = () =&gt; {
  const [state, setState] = useState();
  return (error) =&gt; {
    setState(() =&gt; {
      throw error;
    });
  };
};

class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true };
  }

  render() {
    if (this.state.hasError) {
      return &lt;&gt;Oh no! Something went wrong!&lt;/&gt;;
    }
    return this.props.children;
  }
}

const ErrorComponent = () =&gt; {
  const throwAsyncError = useThrowAsyncError();
  return (
    &lt;button
      onClick={() =&gt; {
        try {
          throw new Error(&quot;error&quot;);
        } catch (e) {
          // this will trigger React to re-render
          // and throw the error again
          throwAsyncError(e);
        }
      }}
    &gt;
      Click me
    &lt;/button&gt;
  );
};

render(
  &lt;ErrorBoundary fallback={&lt;&gt;Wow it is broken!&lt;/&gt;}&gt;
    &lt;ErrorComponent /&gt;
  &lt;/ErrorBoundary&gt;
);</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// this is a custom hook to throw error in async function</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">useThrowAsyncError</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setState</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ErrorBoundary</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDerivedStateFromError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hasError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Oh no! Something went wrong!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">ErrorComponent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> throwAsyncError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useThrowAsyncError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">      </span><span class="token tag attr-name" style="color:#00a4db">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">        </span><span class="token tag script language-javascript keyword control-flow" style="color:#00009f">try</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">          </span><span class="token tag script language-javascript keyword control-flow" style="color:#00009f">throw</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript keyword" style="color:#00009f">new</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript class-name" style="color:#00009f">Error</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript string" style="color:#e3116c">&quot;error&quot;</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">        </span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript keyword control-flow" style="color:#00009f">catch</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript" style="color:#00009f">e</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">          </span><span class="token tag script language-javascript comment" style="color:#999988;font-style:italic">// this will trigger React to re-render</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">          </span><span class="token tag script language-javascript comment" style="color:#999988;font-style:italic">// and throw the error again</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">          </span><span class="token tag script language-javascript function" style="color:#d73a49">throwAsyncError</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript" style="color:#00009f">e</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">        </span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">      </span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">      Click me</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">fallback</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript plain-text" style="color:#00009f">Wow it is broken!</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorComponent</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div><div class="playgroundHeader_dyrN">çµæœ</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Conclusionçš„ç›´æ¥é€£çµ" title="Conclusionçš„ç›´æ¥é€£çµ">â€‹</a></h2><p>åœ¨ React ä¸­ï¼Œæˆ‘å€‘ç„¡æ³•é€é <code>try/catch</code> åŒ…ä½æ•´å€‹ <code>useEffect</code> æˆ–æ˜¯å­å…ƒä»¶ <code>children</code> ä¾†æ•ç²éŒ¯èª¤ï¼Œä½†æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>ErrorBoundary</code> ä¾†é”æˆã€‚ä¸é <code>ErrorBoundary</code> ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚å®ƒç„¡æ³•æ•ç²éåŒæ­¥çš„éŒ¯èª¤ï¼Œä¾‹å¦‚ <code>setTimeout</code>ã€<code>Promise</code>ï¼›å®ƒä¹Ÿç„¡æ³•æ•ç² Event Handler, Callback ä¸­çš„éŒ¯èª¤ï¼Œä¾‹å¦‚ <code>onClick</code>ã€<code>onSubmit</code>ã€‚ä¸éæˆ‘å€‘å¯ä»¥ä½¿ç”¨ä¸€å€‹è‡ªå®šç¾©çš„ <code>useThrowAsyncError</code> ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚æˆ‘å€‘å¯ä»¥åœ¨ <code>catch</code> ä¸­ä½¿ç”¨ <code>useThrowAsyncError</code> å¼·åˆ¶è§¸ç™¼ React é‡æ–°æ¸²æŸ“ï¼Œæœ€å¾Œå†å°‡éŒ¯èª¤ä¸Ÿå›é‡æ–°æ¸²æŸ“çš„ç”Ÿå‘½é€±æœŸä¸­ã€‚</p><p>å¦å¤–ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥è€ƒæ…®ä½¿ç”¨ <a href="https://github.com/bvaughn/react-error-boundary" target="_blank" rel="noopener noreferrer">bvaughn/react-error-boundary</a> é€™å€‹ç¬¬ä¸‰æ–¹å¥—ä»¶ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚é€™å€‹å¥—ä»¶æä¾›äº† <code>&lt;ErrorBoundary&gt;</code> ä»¥åŠ <code>useErrorHandler</code>ï¼Œè®“æˆ‘å€‘æ›´æ–¹ä¾¿çš„ä½¿ç”¨ <code>ErrorBoundary</code> çš„æ–¹å¼æ•æ‰éŒ¯èª¤ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ¨™ç±¤ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/react">react</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/js">js</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/error-boundary">error-boundary</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/windsuzu/windsuzu.github.io/tree/master/docs/frontend/react-next/2023-02-28-error-boundary-guide.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç·¨è¼¯æ­¤é </a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">æœ€å¾Œ<!-- -->æ–¼ <b><time datetime="2023-03-19T10:19:06.000Z">2023å¹´3æœˆ19æ—¥</time></b> <!-- -->æ›´æ–°</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡ä»¶åˆ†é å°è¦½"><a class="pagination-nav__link pagination-nav__link--prev" href="/frontend/react-next/usestate-vs-usesignal"><div class="pagination-nav__sublabel">ä¸Šä¸€é </div><div class="pagination-nav__label">ğŸŸ¨ useState vs useSignal</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/frontend/react-next/is-usestate-asynchronous"><div class="pagination-nav__sublabel">ä¸‹ä¸€é </div><div class="pagination-nav__label">ğŸŸ© Is useState Asynchronous?</div></a></nav></div><br></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-do-we-need-to-catch-errors-in-react" class="table-of-contents__link toc-highlight">Why do we need to catch errors in React?</a></li><li><a href="#review-catching-errors-in-javascript" class="table-of-contents__link toc-highlight">Review: Catching Errors in JavaScript</a></li><li><a href="#problems-of-trycatch-in-react" class="table-of-contents__link toc-highlight">Problems of <code>try/catch</code> in React</a><ul><li><a href="#1-catch-errors-in-useeffect" class="table-of-contents__link toc-highlight">1. Catch errors in <code>useEffect</code></a></li><li><a href="#2-catch-errors-in-children" class="table-of-contents__link toc-highlight">2. Catch errors in <code>children</code></a></li><li><a href="#3-catch-errors-in-render-and-change-state" class="table-of-contents__link toc-highlight">3. Catch errors in <code>render</code> and Change state</a></li></ul></li><li><a href="#errorboundary-in-react" class="table-of-contents__link toc-highlight">ErrorBoundary in React</a></li><li><a href="#errorboundary-with-asynchronous-error" class="table-of-contents__link toc-highlight">ErrorBoundary with Asynchronous Error</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">é–±è®€å‰ç«¯</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/frontend/html-css/intro">HTML / CSS</a></li><li class="footer__item"><a class="footer__link-item" href="/frontend/js-ts/intro">JavaScript / TypeScript</a></li><li class="footer__item"><a class="footer__link-item" href="/frontend/react-next/intro">React / Next</a></li><li class="footer__item"><a class="footer__link-item" href="/frontend/other/intro">Other</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç­†è¨˜å’Œéƒ¨è½æ ¼</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/learning/intro">å­¸ç¿’ç­†è¨˜</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">éƒ¨è½æ ¼</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.github.com/windsuzu" target="_blank" rel="noopener noreferrer" class="footer__link-item">My GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Jay's Domain. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0c6ee512.js"></script>
<script src="/assets/js/main.6782d141.js"></script>
</body>
</html>