---
id: usestate-vs-usesignal
title: useState vs useSignal
description: useSignal() æ˜¯ä¸€ç¨®é¡ä¼¼æ–¼ React ä¸­çš„ useState() å„²å­˜æ‡‰ç”¨ç¨‹åºç‹€æ…‹çš„æ–¹å¼ã€‚ä¸åŒä¹‹è™•åœ¨æ–¼ï¼ŒuseSignal() è¿”å›ä¸€å€‹ getter å’Œä¸€å€‹ setterï¼Œè€Œ React çš„ useState() å‰‡è¿”å›ä¸€å€‹ value å’Œä¸€å€‹ setterã€‚é€™è®“ Signal å¯ä»¥é€éè¨‚é–±è€…æ¨¡å¼ä¾†è¿½è¹¤èª°åœ¨ä½¿ç”¨ stateï¼Œä¸¦åœ¨ state æ›´æ–°æ™‚é€šçŸ¥è¨‚é–±è€…ï¼Œæ¸›å°‘ä¸å¿…è¦çš„ re-renderã€‚
sidebar_label: ğŸŸ¨ useState vs useSignal
hide_title: true
hide_table_of_contents: false
tags: [react, usestate, usesignal, signal, qwik, preact, solid]
draft: false
last_updated: 2023-03-19
---

<profile
  title="useSignal() is the Future of Web Frameworks"
  url="https://www.builder.io/blog/usesignal-is-the-future-of-web-frameworks"
  author="MIÅ KO HEVERY"
  level="intermediate"
  category={["react/next"]}
/>

`useSignal()` å¸¸è¦‹æ–¼ React ä»¥å¤–çš„æ¡†æ¶ï¼Œä¾‹å¦‚ Vueã€Preactã€Solid å’Œ Qwikã€‚é€™ç¯‡æ–‡ç« ä»¥ React ç‚ºåŸºç¤ï¼Œæ¯”è¼ƒäº† `useState()` å’Œ `useSignal()` çš„å·®ç•°ï¼Œä¸¦è§£é‡‹äº†ç‚ºä»€éº¼ `useSignal()` æ˜¯æœªä¾†çš„è¶¨å‹¢ã€‚

`useSignal()` æ˜¯ä¸€ç¨®é¡ä¼¼æ–¼ React ä¸­çš„ useState() å„²å­˜æ‡‰ç”¨ç¨‹åºç‹€æ…‹çš„æ–¹å¼ã€‚ä¸åŒä¹‹è™•åœ¨æ–¼ï¼Œ`useSignal()` è¿”å›ä¸€å€‹ getter å’Œä¸€å€‹ setterï¼Œè€Œ React çš„ `useState()` å‰‡è¿”å›ä¸€å€‹ value å’Œä¸€å€‹ setterã€‚é€™è®“ Signal å¯ä»¥é€éè¨‚é–±è€…æ¨¡å¼ä¾†è¿½è¹¤èª°åœ¨ä½¿ç”¨ stateï¼Œä¸¦åœ¨ state æ›´æ–°æ™‚é€šçŸ¥è¨‚é–±è€…ï¼Œæ¸›å°‘ä¸å¿…è¦çš„ re-renderã€‚

## useState() vs useSignal()

å…©è€…æœ€æ ¹æœ¬çš„å·®ç•°æ˜¯ `useState()` å›å‚³çš„ç¬¬ä¸€å€‹å€¼æ˜¯ valueï¼ˆStateValueï¼‰ï¼Œè€Œ `useSignal()` å›å‚³çš„ç¬¬ä¸€å€‹å€¼æ˜¯ getterï¼ˆStateReferenceï¼‰ã€‚å›å‚³ getter çš„å¥½è™•æ˜¯ï¼Œå®ƒå¯ä»¥åœ¨éœ€è¦æ™‚æ‰å–å¾— valueï¼Œé€™æ¨£å¯ä»¥æ¸›å°‘ä¸å¿…è¦çš„è¨ˆç®—ã€‚é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼ `useSignal()` å¯ä»¥åœ¨ä¸è§¸ç™¼ re-render çš„æƒ…æ³ä¸‹æ›´æ–° state çš„åŸå› ã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ SolidJS çš„ä¾‹å­ï¼š

```js title="SolidJS Counter with useSignal()"
export function Counter() {
  const [getCount, setCount] = createSignal(0);
  return <button onClick={() => setCount(getCount() + 1)}>{getCount()}</button>;
}
```

åœ¨ Signal ç³»çµ±ä¸­ï¼Œå‘¼å« getter (`getCount()`) çš„äººï¼Œç­‰æ–¼è¨‚é–±äº†è©² Signalï¼Œè€Œ setter (`setCount()`) å‰‡æ˜¯é€šçŸ¥æ‰€æœ‰è¨‚é–±è€…æ›´æ–° stateï¼Œé€™ä»£è¡¨è‘— Signal ç³»çµ±å¯ä»¥çŸ¥é“èª°åœ¨ä½¿ç”¨ stateï¼Œä¸¦åœ¨ state æ›´æ–°æ™‚é€šçŸ¥è¨‚é–±è€…ï¼Œæ˜¯ä¸€å€‹ reactive çš„ç³»çµ±ã€‚

åœ¨ React ä¸­ï¼Œ`useState()` å›å‚³çš„ç¬¬ä¸€å€‹å€¼æ˜¯ valueï¼Œé€™ä»£è¡¨è‘— React ç„¡æ³•çŸ¥é“ state è¢«ä½¿ç”¨çš„æƒ…æ³ï¼Œå› æ­¤æ¯æ¬¡ state æ›´æ–°æ™‚ï¼Œéƒ½æœƒé‡æ–° render æ•´å€‹ component treeï¼Œæ˜¯ä¸€å€‹é reactive çš„ç³»çµ±ï¼Œè€Œä¸”è¨ˆç®—é‡ä¹Ÿæœƒæ¯”è¼ƒå¤§ã€‚

## useRef()

React çš„ `useRef()` èˆ‡ `useSignal()` ååˆ†ç›¸ä¼¼ï¼Œå› ç‚º `useRef()` ä¹Ÿæ˜¯ reference çš„æ¦‚å¿µï¼Œåªæ˜¯å®ƒç¼ºä¹äº†è¨‚é–±è¿½è¹¤å’Œé€šçŸ¥çš„åŠŸèƒ½ã€‚è€Œåœ¨ Signal ç³»çµ±ä¸­ï¼Œ`useSignal()` ä¹Ÿå¯ä»¥ä½œç‚º `useRef()` ä¾†ä½¿ç”¨ã€‚

## useMemo()

è€ƒæ…®ä»¥ä¸‹ React `useMemo` çš„ä¾‹å­ï¼šå³ä½¿æˆ‘å€‘æŠŠ `<Display/>` åŒ…åœ¨ `React.memo()`ï¼Œä½†æ˜¯ç•¶ state æ›´æ–°æ™‚ï¼Œ`<Counter/>` å’Œè£è‘— countA çš„ `<Display/>` éƒ½æœƒé‡æ–° renderã€‚

```jsx title="React useMemo()" live noInline
const Display = ({ count }) => {
  console.log(`<Display count={${count}}/>`);
  return <div>{count}</div>;
};
const MemoDisplay = React.memo(Display);

const Counter = () => {
  console.log(`<Counter />`);
  const [countA, setCountA] = React.useState(0);
  const [countB, setCountB] = React.useState(0);
  return (
    <div>
      <button onClick={() => setCountA(countA + 1)}>A</button>
      <button onClick={() => setCountB(countB + 1)}>B</button>
      <MemoDisplay count={countA} />
      <MemoDisplay count={countB} />
    </div>
  );
};

render(<Counter />);
```

```bash title="Console output"
# Initial render output
<Counter />
<Display count={0}/>
<Display count={0}/>

# "A" button clicked
<Counter />
<Display count={1}/>
```

ä½† Signal ç³»çµ±å®Œå…¨ä¸éœ€è¦ `useMemo()`ï¼Œå› ç‚ºå®ƒæœ¬èº«å°±èƒ½æ‰¾åˆ°éœ€è¦ state çš„åœ°æ–¹ï¼Œä¸¦åœ¨ state æ›´æ–°æ™‚é€šçŸ¥é‚£äº›è¨‚é–±è€…ï¼Œå› æ­¤ä¸éœ€è¦é¡å¤–çš„ memoizationã€‚è€ƒæ…®ä»¥ä¸‹ Qwik çš„ä¾‹å­ï¼š

```js title="Qwik Counter with useSignal()"
export function Counter() {
  console.log(`<Counter />`);
  const countA = useSignal(0);
  const countB = useSignal(0);
  return (
    <div>
      <button onClick$={() => countA.value++}>A</button>
      <button onClick$={() => countB.value++}>B</button>
      <Display count={countA.value} />
      <Display count={countA.value} />
    </div>
  );
}

export const Display = component$(({ count }: { count: number }) => {
  console.log(`<Display count={${count}}/>`);
  return <div>{count}</div>;
});
```

```bash title="Console output"
# Initial render output
<Counter />
<Display count={0}/>
<Display count={0}/>

# "A" button clicked
# nothing is re-rendered
```

å¯ä»¥çœ‹åˆ°ï¼Œç•¶ state æ›´æ–°æ™‚ï¼Œé™¤äº†ä¸æœƒé‡æ–° render `<Counter/>`ï¼Œä¹Ÿä¸æœƒé‡æ–° render `<Display/>`ï¼Œå› ç‚º Signal ç³»çµ±å·²ç¶“çŸ¥é“ä½¿ç”¨ count çš„åœ°æ–¹åªæœ‰ `<Display/>` ä¸­çš„ text nodeï¼Œå› æ­¤åªæœƒæ›´æ–° text nodeã€‚

Signal ç³»çµ±ä¸¦ä¸æ˜¯ä¸€å€‹æ–°çš„æ¦‚å¿µï¼Œå®ƒåœ¨ [knockout.js](https://knockoutjs.com/) ç”šè‡³æ›´æ—©çš„æ¡†æ¶å‰å°±å·²ç¶“å‡ºç¾éã€‚åªæ˜¯è¿‘å¹¾å¹´çš„ compiler å’Œ JSX ç™¼å±•ï¼Œè®“ Signal ç³»çµ±è®Šå¾—æ›´åŠ ç°¡æ½”ä¸”å®¹æ˜“ä½¿ç”¨ã€‚
