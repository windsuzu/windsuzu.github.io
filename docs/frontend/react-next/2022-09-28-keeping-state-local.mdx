---
id: keeping-state-local
title: Keeping State Local
description: åœ¨ React çš„ç‹€æ…‹ç®¡ç†ä¸­ï¼Œæœ‰ä¸€å€‹é»ƒé‡‘è¦å‰‡ï¼Œå°±æ˜¯ç›¡å¯èƒ½åœ°å°‡ç‹€æ…‹ä¿æŒåœ¨å…ƒä»¶æœ¬èº«ã€‚é€™æ„å‘³è‘—ä½ æ‡‰è©²åªåœ¨éœ€è¦å®ƒçš„å…ƒä»¶ä¸­å®£å‘Šç‹€æ…‹ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½å°‡ç‹€æ…‹å®£å‘Šåœ¨æœ€ä¸Šå±¤çš„å…ƒä»¶ä¸­ã€‚åœ¨æœ€ä¸Šå±¤å®£å‘Šç‹€æ…‹ï¼Œå¯èƒ½æœƒå°è‡´ä¸å¿…è¦çš„è¤‡é›œæ€§ï¼Œä½¿ä½ çš„ç¨‹å¼ç¢¼é›£ä»¥ç¶­è­·ã€‚
sidebar_label: ğŸŸ© Keeping State Local
hide_title: true
hide_table_of_contents: false
tags: [react, state-management]
draft: false
last_update:
  date: 2022-09-28
---

<profile
  title="Are You Making This React State Mistake?"
  url="https://www.youtube.com/watch?v=NZqMVUEiDIw"
  author="Web Dev Simplified"
  level="beginner"
  category={["react/next"]}
/>

åœ¨ React çš„ç‹€æ…‹ç®¡ç†ä¸­ï¼Œæœ‰ä¸€å€‹é»ƒé‡‘è¦å‰‡ï¼Œå°±æ˜¯ç›¡å¯èƒ½åœ°å°‡ç‹€æ…‹ä¿æŒåœ¨å…ƒä»¶æœ¬èº«ã€‚é€™æ„å‘³è‘—ä½ æ‡‰è©²åªåœ¨éœ€è¦å®ƒçš„å…ƒä»¶ä¸­å®£å‘Šç‹€æ…‹ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½å°‡ç‹€æ…‹å®£å‘Šåœ¨æœ€ä¸Šå±¤çš„å…ƒä»¶ä¸­ã€‚åœ¨æœ€ä¸Šå±¤å®£å‘Šç‹€æ…‹ï¼Œå¯èƒ½æœƒå°è‡´ä¸å¿…è¦çš„è¤‡é›œæ€§ï¼Œä½¿ä½ çš„ç¨‹å¼ç¢¼é›£ä»¥ç¶­è­·ã€‚

## Keeping State Local

è€ƒæ…®ä¸‹é¢é€™å€‹è¨ˆæ•¸å™¨çš„ç¯„ä¾‹ï¼Œæˆ‘å€‘åœ¨æœ€ä¸Šå±¤çš„å…ƒä»¶ä¸­å®£å‘Šäº† `count` å’Œ `setCount` çš„ç‹€æ…‹ï¼Œç„¶å¾Œå°‡å®ƒå€‘å‚³éçµ¦ `Counter` å…ƒä»¶ã€‚ä½†æ˜¯ï¼Œé€™å€‹ç‹€æ…‹åªåœ¨ `Counter` å…ƒä»¶ä¸­ä½¿ç”¨ï¼Œæˆ–è¨±æˆ‘å€‘å¯ä»¥å°‡ç‹€æ…‹ç§»å‹•åˆ° `Counter` å…ƒä»¶ä¸­ã€‚

```jsx
const App = () => {
  const [count, setCount] = useState(0);
  return <Counter count={count} setCount={setCount} />;
};
```

ä»¥ä¸‹æ˜¯é‡æ§‹å¾Œçš„ç¨‹å¼ç¢¼ï¼Œæˆ‘å€‘å°‡ `count` å’Œ `setCount` çš„ç‹€æ…‹å®£å‘Šç§»å‹•åˆ° `Counter` å…ƒä»¶ä¸­ï¼Œé€™æ¨£å°±å¯ä»¥ç°¡åŒ–ç¨‹å¼ç¢¼ï¼Œä¸¦ä½¿å…¶æ›´å®¹æ˜“ç¶­è­·ã€‚

- ç•¶ä½ æœ‰å…¶ä»–å…ƒä»¶éœ€è¦ä½¿ç”¨ `Counter` æ™‚ï¼Œä½ ä¸éœ€è¦å†å‚³éä¸€æ¬¡ `count` å’Œ `setCount`ã€‚
- ç•¶ä½ éœ€è¦ä¿®æ”¹ `Counter` çš„ç‹€æ…‹æ™‚ï¼Œä½ ä¸æœƒå½±éŸ¿åˆ° App ä¸­çš„å…¶ä»–å…ƒä»¶ã€‚

```jsx live noInline
const App = () => {
  return <Counter />;
};

const Counter = () => {
  const [count, setCount] = useState(0);
  return (
    <div style={{ display: "flex", alignItems: "center", gap: "0.5rem" }}>
      <button onClick={() => setCount((prev) => prev - 1)}>-</button>
      <span>{count}</span>
      <button onClick={() => setCount((prev) => prev + 1)}>+</button>
    </div>
  );
};

render(<App />);
```

## Keeping Form Data Local

é€™å€‹é»ƒé‡‘è¦å‰‡ä¸åƒ…é™æ–¼è¨ˆæ•¸å™¨ï¼Œå®ƒä¹Ÿé©ç”¨æ–¼è¡¨å–®ã€‚è€ƒæ…®ä»¥ä¸‹ç¯„ä¾‹ã€‚æˆ‘å€‘æœ‰ä¸€å€‹ `LoginForm` å…ƒä»¶ï¼Œä½†åœ¨ `App` æˆ‘å€‘åªå¥½å¥‡ `LoginForm` æœ€çµ‚æäº¤çš„è¡¨å–®æ•¸æ“šï¼Œè€Œä¸æ˜¯ `LoginForm` çš„ç•¶å‰ç‹€æ…‹ (`formData`)ã€‚æ‰€ä»¥æˆ‘å€‘å¯ä»¥å°‡ `formData` çš„ç‹€æ…‹å’Œ `updateFormData` å‡½å¼ç§»å‹•åˆ° `LoginForm` å…ƒä»¶ä¸­ã€‚

```jsx
const App = () => {
  const [formData, setFormData] = useState({ email: "", password: "" });

  function updateFormData(newData) {
    setFormData((prev) => ({ ...prev, ...newData }));
  }

  function onSubmit() {
    console.log(formData);
  }

  return (
    <LoginForm
      data={formData}
      updateData={updateFormData}
      onSubmit={onSubmit}
    />
  );
};
```

ä»¥ä¸‹æ˜¯é‡æ§‹å¾Œçš„ç¨‹å¼ç¢¼ï¼Œæˆ‘å€‘å°‡ `formData` çš„ç‹€æ…‹å’Œ `updateFormData` å‡½å¼ç§»å‹•åˆ° `LoginForm` å…ƒä»¶ä¸­ã€‚ç”±æ–¼ `LoginForm` ä¸éœ€è¦éš¨æ™‚æ›´æ–°æˆ–æª¢æŸ¥ `formData` çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ä½¿ç”¨ `useRef` åœ¨æœ€å¾Œæäº¤æ™‚ç²å–è¡¨å–®æ•¸æ“šå³å¯ã€‚

```jsx live noInline
const App = () => {
  function onSubmit(formData) {
    console.log(formData);
  }
  return <LoginForm onSubmit={onSubmit} />;
};

const LoginForm = ({ onSubmit }) => {
  const emailRef = useRef();
  const passwordRef = useRef();

  function handleSubmit(e) {
    e.preventDefault();
    onSubmit({
      email: emailRef.current.value,
      password: passwordRef.current.value,
    });
  }

  return (
    <form onSubmit={handleSubmit}>
      <label htmlFor="email">Email</label>
      <input ref={emailRef} type="email" id="email" />
      <label htmlFor="password">Password</label>
      <input ref={passwordRef} type="password" id="password" />
      <button type="submit">Submit</button>
    </form>
  );
};

render(<App />);
```

å°‡ React çš„ç‹€æ…‹ç›¡å¯èƒ½åœ°ä¿æŒåœ¨å…ƒä»¶æœ¬èº«ï¼Œæ˜¯ä¸€å€‹é‡è¦çš„æ¦‚å¿µã€‚é€šéå°‡ç‹€æ…‹ä¿æŒåœ¨å…ƒä»¶æœ¬èº«ï¼Œå¯ä»¥ç°¡åŒ–ç¨‹å¼ç¢¼ï¼Œæ¸›å°‘è¤‡é›œæ€§ï¼Œä¸¦ä½¿ç¨‹å¼ç¢¼æ›´å®¹æ˜“ç¶­è­·ã€‚
