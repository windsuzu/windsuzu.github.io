---
id: constant-vs-mutation
title: Constant vs Mutation
description: const å¸¸å¸¸æœƒè®“ JavaScript çš„åˆå­¸è€…æ„Ÿåˆ°å›°æƒ‘ã€‚ä¾‹å¦‚ç‚ºä»€éº¼ç”¨ const åˆå§‹åŒ–çš„ object æˆ– array å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†æ˜¯åˆ©ç”¨ const åˆå§‹åŒ–çš„ string æˆ– number å»ä¸èƒ½è¢«ä¿®æ”¹å‘¢ï¼Ÿé€™æ˜¯å› ç‚ºé€šå¸¸æˆ‘å€‘ä¿®æ”¹ object æˆ– array çš„å‹•ä½œ (push, splice) ç¨±ç‚º mutationï¼Œä¸¦ä¸æœƒä¿®æ”¹åˆ°ç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ‰€ä»¥èˆ‡ const ä¸¦ç„¡é—œä¿‚ã€‚è€Œä¿®æ”¹ string æˆ– number çš„å‹•ä½œç¨±ç‚º reassignmentï¼Œæ˜¯ç›´æ¥ä¿®æ”¹ç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ‰€ä»¥å°±èˆ‡ const å’Œ let æœ‰é—œä¿‚äº†ã€‚
sidebar_label: ğŸŸ© Constant vs Mutation
hide_title: true
hide_table_of_contents: false
tags: [tag1, tag2]
draft: false
last_update:
  date: 2023-06-04
---

<profile
  title="The â€œconstâ€ Deception"
  url="https://www.joshwcomeau.com/javascript/the-const-deception/"
  author="Josh W Comeau"
  level="beginner"
  category={["js/ts"]}
/>

`const` å¸¸å¸¸æœƒè®“ JavaScript çš„åˆå­¸è€…æ„Ÿåˆ°å›°æƒ‘ã€‚ä¾‹å¦‚ç‚ºä»€éº¼ç”¨ `const` åˆå§‹åŒ–çš„ `object` æˆ– `array` å¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†æ˜¯åˆ©ç”¨ `const` åˆå§‹åŒ–çš„ `string` æˆ– `number` å»ä¸èƒ½è¢«ä¿®æ”¹å‘¢ï¼Ÿ

é€™æ˜¯å› ç‚ºé€šå¸¸æˆ‘å€‘ä¿®æ”¹ `object` æˆ– `array` çš„å‹•ä½œ (`push`, `splice`) ç¨±ç‚º **mutation**ï¼Œä¸¦ä¸æœƒä¿®æ”¹åˆ°ç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ‰€ä»¥èˆ‡ `const` ä¸¦ç„¡é—œä¿‚ã€‚è€Œä¿®æ”¹ `string` æˆ– `number` çš„å‹•ä½œç¨±ç‚º **reassignment**ï¼Œæ˜¯ç›´æ¥ä¿®æ”¹ç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ‰€ä»¥å°±èˆ‡ `const` å’Œ `let` æœ‰é—œä¿‚äº†ã€‚

<takeaway
  points={[
    <>
      ä½¿ç”¨ <code>const</code> å‰µå»ºçš„ç‰©ä»¶å¯ä»¥è¢«ä¿®æ”¹ (mutate)ï¼Œä½†æ˜¯ä¸èƒ½è¢«é‡æ–°æŒ‡æ´¾
      (reassign)ã€‚
    </>,
    <>
      mutate æŒ‡çš„æ˜¯ä¿®æ”¹ç‰©ä»¶çš„å…§å®¹ï¼Œä½†æ˜¯ä¸æœƒæ”¹è®Šç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ã€‚ä¾‹å¦‚ä½¿ç”¨
      <code>push</code> ä¿®æ”¹ <code>array</code> çš„å…§å®¹ï¼Œæˆ–æ˜¯ä¿®æ”¹ <code>
        object
      </code> çš„å…§å®¹ï¼š <code>obj.name = 'John'</code>ã€‚
    </>,
    <>
      reassign æŒ‡çš„æ˜¯ä¿®æ”¹ç‰©ä»¶çš„è¨˜æ†¶é«”ä½ç½®ã€‚ä¾‹å¦‚ä½¿ç”¨ <code>=</code> é‡æ–°æŒ‡æ´¾
      <code>string</code> æˆ– <code>number</code> çš„å€¼ã€‚åªæœ‰ä½¿ç”¨ <code>
        let
      </code> å®£å‘Šçš„è®Šæ•¸æ‰èƒ½è¢«é‡æ–°æŒ‡æ´¾ã€‚
    </>,
    <>
      <code>String</code>, <code>Number</code>, <code>Boolean</code>{" "}
      ç­‰éƒ½æ˜¯å±¬æ–¼ä¸å¯ä¿®æ”¹ (immutable) çš„ç‰©ä»¶ï¼Œæ‰€ä»¥ç„¡æ³•è¢« mutateã€‚æˆ‘å€‘åªèƒ½é€é
      reassign çš„æ–¹å¼ä¾†æ”¹è®Šå®ƒå€‘çš„å€¼ã€‚ä¾‹å¦‚{" "}
      <code>let name = 'John'; name = 'Mary';</code> æˆ–æ˜¯{" "}
      <code>let age = 20; age += 1;</code>
    </>,
  ]}
/>

## Variable Reassignment

åœ¨ JavaScript æœ‰å…©ç¨®å®£å‘Šè®Šæ•¸ (variable) çš„æ–¹å¼ï¼š`const` å’Œ `let`ã€‚å¦‚æœä½ ç”¨ `const` å®£å‘Šè®Šæ•¸ï¼Œå°±ä»£è¡¨é€™å€‹è®Šæ•¸çš„å€¼ä¸èƒ½è¢«é‡æ–°æŒ‡æ´¾ (reassign)ã€‚å¦‚æœä½ ç”¨ `let` å®£å‘Šè®Šæ•¸ï¼Œå°±ä»£è¡¨é€™å€‹è®Šæ•¸çš„å€¼å¯ä»¥è¢«é‡æ–°æŒ‡æ´¾ã€‚é€™å€‹è¦å‰‡å°æ–¼ primitive types (`string`, `number`, `boolean`, `null`, `undefined`) å’Œ object (`object`, `array`) éƒ½æ˜¯ä¸€æ¨£çš„ã€‚

### Primitive Types

```js title="âŒ ä¸è¡Œé‡æ–°æŒ‡æ´¾ const å®£å‘Šçš„è®Šæ•¸ (primitive types)"
const name = "John";
// error-next-line
name = "Mary"; // TypeError: Assignment to constant variable.
```

```js title="âœ… å¯ä»¥é‡æ–°æŒ‡æ´¾ let å®£å‘Šçš„è®Šæ•¸ (primitive types)"
let name = "John";
name = "Mary";
// highlight-next-line
console.log(name); // Mary
```

### Object Types

```js title="âŒ ä¸è¡Œé‡æ–°æŒ‡æ´¾ const å®£å‘Šçš„è®Šæ•¸ (object types)"
const person = { name: "John" };
// error-next-line
person = { name: "Mary" }; // TypeError: Assignment to constant variable.
```

```js title="âœ… å¯ä»¥é‡æ–°æŒ‡æ´¾ let å®£å‘Šçš„è®Šæ•¸ (object types)"
let person = { name: "John" };
person = { name: "Mary" };
// highlight-next-line
console.log(person); // { name: 'Mary' }
```

## Variable Mutation

Object (`object`, `array`) åœ¨ `const` çš„æƒ…æ³ä¸‹ï¼Œé›–ç„¶ä¸èƒ½é‡æ–°æŒ‡æ´¾ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹ (mutate)ã€‚é€™æ˜¯å› ç‚º `const` åªæ˜¯ä¿è­‰è®Šæ•¸çš„è¨˜æ†¶é«”ä½ç½®ä¸æœƒè¢«æ”¹è®Šï¼Œä½†æ˜¯ä¸¦ä¸ä¿è­‰åœ¨åŒæ¨£çš„è¨˜æ†¶é«”ä¸‹ï¼Œè®Šæ•¸çš„å…§å®¹ä¸æœƒè¢«æ”¹è®Šã€‚

```js title="âœ… å¯ä»¥ä¿®æ”¹ const å®£å‘Šçš„è®Šæ•¸ (object )"
const person = { name: "John" };
// highlight-next-line
person.name = "Mary";
console.log(person); // { name: 'Mary' }
```

```js title="âœ… å¯ä»¥ä¿®æ”¹ const å®£å‘Šçš„è®Šæ•¸ (array)"
const numbers = [1, 2, 3];
// highlight-next-line
numbers.push(4);
console.log(numbers); // [ 1, 2, 3, 4 ]
```

:::tip
å¦‚æœæƒ³è¦é¿å…è®Šæ•¸è¢«ä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ `Object.freeze` ä¾†å‡çµç‰©ä»¶ã€‚

```js
const person = Object.freeze({ name: "John" });
// highlight-next-line
person.name = "Mary";
console.log(person); // { name: 'John' }
```

ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œ`Object.freeze` åªæœƒå‡çµç¬¬ä¸€å±¤çš„ç‰©ä»¶ï¼Œå¦‚æœç‰©ä»¶å…§é‚„æœ‰å…¶ä»–ç‰©ä»¶ï¼Œé‚£éº¼é€™äº›ç‰©ä»¶é‚„æ˜¯å¯ä»¥è¢«ä¿®æ”¹ã€‚å¦‚æœè¦å‡çµæ‰€æœ‰çš„å±¤ç´šï¼Œå¯ä»¥ä½¿ç”¨ [deep-freeze](https://stackoverflow.com/questions/34776846/how-to-freeze-nested-objects-in-javascript) çš„æ–¹å¼å‡çµæ‰€æœ‰çš„å±¤ç´šã€‚

```js
const person = Object.freeze({ name: "John", address: { city: "Taipei" } });
// highlight-next-line
person.address.city = "New Taipei";
console.log(person); // { name: 'John', address: { city: 'New Taipei' } }
```

å¦å¤–ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥é€é TypeScript çš„ `as const` åœ¨ç·¨è­¯å‰å°±ç¢ºä¿ç‰©ä»¶ä¸æœƒè¢«ä¿®æ”¹ã€‚

```ts
const person = { name: "John" } as const;
// error-next-line
person.name = "Mary"; // error: Cannot assign to 'name' because it is a read-only property.
```

:::

## Primitive Types

Primitives (`string`, `number`, `boolean`, `null`, `undefined`) æŒ‡çš„æ˜¯ä¸å¯ä¿®æ”¹ (immutable) çš„ç‰©ä»¶ã€‚é€™ä»£è¡¨æˆ‘å€‘ç„¡æ³•é€é mutate çš„æ–¹å¼ä¾†æ”¹è®Šå®ƒå€‘çš„å€¼ï¼Œæˆ‘å€‘åªèƒ½é€é reassign çš„æ–¹å¼é‡æ–°åˆ†é…ä¸€å€‹è¨˜æ†¶é«”ä½ç½®ä¾†æ”¹è®Šå®ƒå€‘çš„å€¼ã€‚

```js
let name = "John";
name = "Mary";
console.log(name); // Mary

let age = 20;
age += 1;
console.log(age); // 21
```
