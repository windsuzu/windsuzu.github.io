---
id: webpack-beginner
title: Webpack Beginner
description: æœ¬æ–‡ä»‹ç´¹äº†åœ¨ç¶²é é–‹ç™¼ä¸­ä½¿ç”¨æ¨¡çµ„åŒ–çš„å•é¡ŒåŠè§£æ±ºæ–¹æ³•ï¼Œä»¥åŠä½¿ç”¨ Webpack æ‰“åŒ…å·¥å…·çš„éç¨‹å’ŒæŠ€å·§ã€‚æ–‡ç« ä¸­è©³ç´°ä»‹ç´¹äº†åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ ES6 çš„æ¨¡çµ„åŒ–èªæ³•çš„é™åˆ¶ï¼Œä»¥åŠä½¿ç”¨ Webpack å¯ä»¥è§£æ±ºçš„å•é¡Œã€‚æ­¤å¤–ï¼Œæ–‡ç« é‚„è¬›è§£äº†å¦‚ä½•é…ç½® Webpack ä¸¦ä½¿ç”¨å…¶æ‰“åŒ…åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Webpack çš„ loader ä¾†è™•ç† CSSã€åœ–ç‰‡ç­‰è³‡æºã€‚
sidebar_label: ğŸŸ© Webpack Beginner
hide_title: true
hide_table_of_contents: false
tags: [webpack]
draft: false
last_updated: 2022-10-09
---

<profile
  title="webpack æ–°æ‰‹æ•™å­¸ä¹‹æ·ºè«‡æ¨¡çµ„åŒ–èˆ‡ snowpack"
  url="https://blog.techbridge.cc/2020/01/22/webpack-%E6%96%B0%E6%89%8B%E6%95%99%E5%AD%B8%E4%B9%8B%E6%B7%BA%E8%AB%87%E6%A8%A1%E7%B5%84%E5%8C%96%E8%88%87-snowpack/"
  author="TechBridge æŠ€è¡“å…±ç­†éƒ¨è½æ ¼ huli"
  level="beginner"
  category={["other"]}
/>

æœ¬æ–‡ä»‹ç´¹äº†åœ¨ç¶²é é–‹ç™¼ä¸­ä½¿ç”¨æ¨¡çµ„åŒ–çš„å•é¡ŒåŠè§£æ±ºæ–¹æ³•ï¼Œä»¥åŠä½¿ç”¨ Webpack æ‰“åŒ…å·¥å…·çš„éç¨‹å’ŒæŠ€å·§ã€‚æ–‡ç« ä¸­è©³ç´°ä»‹ç´¹äº†åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ ES6 çš„æ¨¡çµ„åŒ–èªæ³•çš„é™åˆ¶ï¼Œä»¥åŠä½¿ç”¨ Webpack å¯ä»¥è§£æ±ºçš„å•é¡Œã€‚æ­¤å¤–ï¼Œæ–‡ç« é‚„è¬›è§£äº†å¦‚ä½•é…ç½® Webpack ä¸¦ä½¿ç”¨å…¶æ‰“åŒ…åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Webpack çš„ loader ä¾†è™•ç† CSSã€åœ–ç‰‡ç­‰è³‡æºã€‚

## Module and CommonJS

åœ¨ ES6 (2015) ä¹‹å‰ï¼ŒJS çš„æ¨¡çµ„åŒ–æ²’æœ‰ä»»ä½•æ¨™æº–æˆ–è¦å‰‡å¯ä»¥éµå¾ªï¼Œä»»ä½•äººéƒ½å¯ä»¥å‰µå»ºè‡ªå·±çš„ `import/export` èªæ³•ã€‚ä¾‹å¦‚åœ¨ä»¥ä¸‹çš„ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨ `module.exports` èˆ‡ `require` ä¾†å¯¦ç¾æ¨¡çµ„åŒ–ã€‚é€™ç¨®æ–¹å¼å°±æ˜¯ **CommonJS** çš„æ¨¡çµ„åŒ–è¦ç¯„ï¼Œæ˜¯ åœ¨ Node.js çš„æ¨¡çµ„åŒ–è¦ç¯„ã€‚

```js
// utils.js
function sum(a, b) {
  return a + b;
}
module.exports = {
  sum,
  name: "utils",
};

// main.js
var obj = require("./utils");
console.log(obj.sum(1, 2)); // 3
console.log(obj.name); // utils
```

## Browser Module and Browserify

æˆ‘å€‘åœ¨ç€è¦½å™¨ä¸­åŸ·è¡Œçš„ JavaScript æ²’æœ‰ä½¿ç”¨ **CommonJS** æˆ–ä»»ä½•å…¶ä»– `import/export` èªæ³•çš„èƒ½åŠ›ã€‚æ–¼æ˜¯ **Browserify** åœ¨ 2011 å¹´è¢«ç™¼æ˜å‡ºä¾†ï¼Œä¸¦èªªï¼š"_Browserify lets you require('modules') in the browser by bundling up all of your dependencies._"ã€‚

Browserify ç°¡å–®åœ°å°‡æ‡‰ç”¨ç¨‹å¼çš„é€²å…¥é»ï¼ˆ`main.js`ï¼‰å’Œæ‰€æœ‰çš„ **æ¨¡çµ„ï¼ˆimport/exportï¼‰** è‡ªå‹•æ‰“åŒ…æˆä¸€å€‹å¯ä»¥åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨çš„ JavaScript æª”æ¡ˆï¼ˆ`bundle.js`ï¼‰ï¼Œè®“ä½ å¯ä»¥åœ¨ç€è¦½å™¨ä¸­è‡ªç”±åœ°ä½¿ç”¨ **CommonJS**ã€‚

```shell
npx browserify main.js -o bundle.js
```

## ES6 ESM (import and export)

æ™‚é–“ä¾†åˆ°äº† 2015 å¹´ï¼ŒES6 ç‚º JavaScript å»ºç«‹äº†ä¸€å€‹æ¨™æº–çš„æ¨¡çµ„åŒ– `import/export` èªæ³•ï¼ˆESMï¼‰ï¼Œä½†å®ƒä»ç„¶ç„¡æ³•ç›´æ¥èˆ‡ç€è¦½å™¨æˆ– Node.js ç›¸å®¹ã€‚

```js
// utils.js
function sum(a, b) {
  return a + b;
}
export default {
  sum,
  name: "utils",
};

// main.js
import obj from "./utils";
console.log(obj.sum(1, 2)); // 3
console.log(obj.name); // utils
```

### ES6 ESM in Node.js

å¦‚æœä½ æƒ³è¦åœ¨ Node.js ä¸­ä½¿ç”¨ ES6 çš„ `import/export` èªæ³•ï¼Œä½ æœ‰å…©ç¨®é¸æ“‡ï¼š

1. å°‡ä½ çš„æª”æ¡ˆå¾ `.js` æ”¹æˆ `.mjs`
2. æˆ–è€…ä½¿ç”¨ **[babel](https://babeljs.io/repl#?browsers=&build=&builtIns=false&spec=false&loose=false&code_lz=JYWwDg9gTgLgBBARgKzgMyhEcDkA6AegFcZgAbAZxwCgBjCAOwojIFM8yIBzACiWTy0AhmR4BmAAwBKKXUbM2HbnxR4GQkK1lA&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=true&fileSize=false&timeTravel=false&sourceType=module&lineWrap=false&presets=es2015%2Creact%2Cstage-2&prettier=false&targets=&version=7.8.3&externalPlugins=)** å°‡ ES6 èªæ³•è½‰æ›æˆ ES5

### ES6 ESM in Browser

å¦‚æœä½ æƒ³è¦åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ ES6 çš„ `import/export` èªæ³•ï¼Œä½ å¿…é ˆç…§è‘—ä»¥ä¸‹æ­¥é©Ÿåšï¼š

1. åœ¨ `<script>` æ¨™ç±¤ä¸­åŠ å…¥ `type="module"` å±¬æ€§

```html
<head>
  <script src="./main.js" type="module"></script>
</head>
```

2. åœ¨ `import` çš„æª”æ¡ˆè·¯å¾‘ä¸­åŠ å…¥å‰¯æª”å `.js`

```js
// main.js
import obj from "./utils.js";
console.log(obj.sum(1, 2)); // 3
console.log(obj.name); // utils
```

3. ä½¿ç”¨ `http://` ä¾†åŸ·è¡Œä½ çš„æ‡‰ç”¨ç¨‹å¼ï¼Œè€Œä¸æ˜¯ `file://`

:::caution
ä¸Šé¢çš„æ­¥é©Ÿä¼¼ä¹å·²ç¶“è§£æ±ºäº† ESM çš„å•é¡Œï¼Œä½†å®ƒä»ç„¶æœ‰å…©å€‹å•é¡Œï¼š

1. ESM åœ¨èˆŠç‰ˆçš„ç€è¦½å™¨ä¸­ä¸è¢«æ”¯æ´ï¼Œä¾‹å¦‚ IE
2. ESM å¾ˆé›£å¾ npm å®‰è£ä¸¦å¼•å…¥å¥—ä»¶ï¼Œä¾‹å¦‚ `import pad from 'pad-left'` é€™æ¨£çš„èªæ³•æ˜¯ä¸è¢«æ”¯æ´çš„ã€‚ä½ å¯èƒ½éœ€è¦æ¯æ¬¡éƒ½ä½¿ç”¨ `import pad from './node_modules/pad-left/index.js` ä¾†å¼•å…¥å¥—ä»¶ã€‚

:::

## Webpack

å› ç‚ºæ¨¡çµ„åŒ–çš„æ©Ÿåˆ¶åœ¨ç€è¦½å™¨ä¸­æœ‰å¾ˆå¤šå•é¡Œï¼ˆä¾‹å¦‚èˆ‡ä¸åŒç€è¦½å™¨å’Œ npm çš„ç›¸å®¹æ€§ï¼‰ï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹å·¥å…·ä¾†è§£æ±ºå®ƒã€‚è€Œé€™å€‹å·¥å…·å°±æ˜¯ **Webpack**ã€‚ **Webpack** èˆ‡ **Browserify** å¾ˆç›¸ä¼¼ã€‚å®ƒä¸åƒ…å…è¨±æˆ‘å€‘çš„ç€è¦½å™¨ JavaScript ä»£ç¢¼è¼•é¬†åœ°åˆ©ç”¨ **ES6** çš„ `import/export` èªæ³•ä¾†ä½¿ç”¨æ¨¡çµ„ï¼Œè€Œä¸”é‚„é™„å¸¶äº†è¨±å¤šæœ‰ç”¨çš„ `loader` å’Œ `plugin`ã€‚è®“æˆ‘å€‘å¯ä»¥åšåˆ°åƒä¸‹é¢é€™æ¨£çš„äº‹æƒ…ï¼š

```js
// main.js
import obj from "./utils.js";
import pad from "pad-left"; // npm install pad-left
console.log(obj.cal(30));
console.log(pad("4", 4, 0));
```

### How to bundle with Webpack

åœ¨ä½¿ç”¨ Webpack æ™‚ï¼Œæˆ‘å€‘é¦–å…ˆéœ€è¦å»ºç«‹ä¸€å€‹è¨­å®šæª”ï¼ˆ`webpack.config.js`ï¼‰ã€‚åœ¨è¨­å®šæª”ä¸­ï¼Œæˆ‘å€‘éœ€è¦å®šç¾©ä¸€äº›åŸºæœ¬çš„åƒæ•¸ï¼Œä¾‹å¦‚æ‡‰ç”¨ç¨‹å¼çš„é€²å…¥é»ï¼ˆ`./main.js`ï¼‰ï¼Œä»¥åŠç”¢ç”Ÿçš„æ‰“åŒ…æª”æ¡ˆçš„æª”åå’Œä½ç½®ã€‚Webpack ä¹Ÿæœ‰ä¸€å€‹ `mode` åƒæ•¸ï¼Œå¯ä»¥åœ¨ **development** å’Œ **production** ä¹‹é–“åˆ‡æ›ã€‚æˆ‘å€‘å¯ä»¥ä½¿ç”¨ **development mode** è®“æ‰“åŒ…çš„é€Ÿåº¦åœ¨ development æ™‚è®Šå¿«ã€‚

```js
// webpack.config.js
module.exports = {
  mode: "development", // or 'production'
  entry: "./main.js",
  output: {
    // __dirname means using the same folder as this config
    path: __dirname,
    filename: "webpack_bundle.js",
  },
};
```

æ¥è‘—ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ `npx webpack` ä¾†åŸ·è¡Œ Webpackã€‚Webpack æœƒè‡ªå‹•è®€å– `webpack.config.js` ä¸¦åŸ·è¡Œæ‰“åŒ…ã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ `npx webpack --config webpack.config.js` ä¾†åŸ·è¡Œ Webpackã€‚

```shell
npm init -y
npm install webpack webpack-cli --save-dev
npx webpack --config webpack.config.js
```

æœ€å¾Œï¼Œæˆ‘å€‘éœ€è¦åœ¨ `index.html` ä¸­åŠ å…¥æ‰“åŒ…å¥½çš„æª”æ¡ˆ `webpack_bundle.js` å°±å¯ä»¥äº†ã€‚

:::info
ä½¿ç”¨ webpack ç”¢ç”Ÿçš„ bundle æª”æ¡ˆå¯ä»¥ä¸éœ€è¦æŠŠ `type=module` åŠ åœ¨ `<script>` æ¨™ç±¤ä¸­ã€‚  
:::

```html
<head>
  <script src="./webpack_bundle.js"></script>
</head>
```

### The power of webpack (loaders)

Webpack é™¤äº†è§£æ±ºæ¨¡çµ„åŒ–çš„å•é¡Œä¹‹å¤–ï¼Œé‚„å¯ä»¥è®“æˆ‘å€‘ç›´æ¥åœ¨ JavaScript ä¸­å¼•å…¥åœ–ç‰‡æˆ– CSSã€‚é€™å€‹åŠŸèƒ½èˆ‡ JavaScript æˆ– ES6 å®Œå…¨ç„¡é—œï¼Œå®Œå…¨æ˜¯ç”± webpack å°‡åœ–ç‰‡å’Œ CSS æ¨¡çµ„åŒ–æ‰€é”æˆçš„ã€‚

```js
import Image from "./assets/banner.png";
import styles from "style.css";
```

ç‚ºäº†é”æˆé€™äº›åŠŸèƒ½ï¼ŒWebpack å®šç¾©äº†ä¸€äº› `loader`ï¼Œä¸åŒçš„ `loader` è™•ç†ä¸åŒçš„è³‡æºã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€å€‹ SCSS loader ä¾†è¼‰å…¥ SCSS æª”æ¡ˆï¼ŒWebpack æœƒå¹«ä½ å°‡å®ƒå€‘ç·¨è­¯æˆç´” CSSã€‚æˆ–æ˜¯ä½ å¯ä»¥ä½¿ç”¨ ES10 ä¾†æ’°å¯«ä½ çš„ JSï¼ŒWebpack æœƒä½¿ç”¨ `babel-loader` å°‡å®ƒè½‰æ›æˆ ES5ã€‚

<fig
  caption="Webpack çš„ loader å¯ä»¥è®“æˆ‘å€‘ç›´æ¥åœ¨ JavaScript ä¸­å¼•å…¥åœ–ç‰‡æˆ– CSSã€‚"
  src="/img/reading/other/2022-10-09-webpack-beginner/webpack.png"
/>

Webpack é‚„å¯ä»¥åœ¨æ‰“åŒ…çš„éç¨‹ä¸­åšåˆ°æ›´å¤šæœ‰è¶£çš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼š

1. å°‡ JS åš **uglify**
2. å°‡ CSS åš **minify**
3. ç‚ºæ‰“åŒ…å¥½çš„æª”æ¡ˆåŠ ä¸Š **hash**
4. å°‡ä¸åŒçš„æª”æ¡ˆæ‰“åŒ…æˆä¸åŒçš„é é¢ï¼Œé€™æ¨£ä½ å°±ä¸éœ€è¦ä¸€æ¬¡è¼‰å…¥æ‰€æœ‰çš„æª”æ¡ˆ
5. åœ¨éœ€è¦æ™‚ **å‹•æ…‹å¼•å…¥** JS

## Review

åœ¨ä½ é–±è®€å®Œé€™ç¯‡æ–‡ç« ä¹‹å¾Œï¼Œä½ æ‡‰è©²å¯ä»¥å›ç­”é€™äº›å•é¡Œï¼š

<details>
  <summary>
    1. ç‚ºä»€éº¼å¾ˆå¤šå°ˆæ¡ˆï¼ˆä¾‹å¦‚ Reactï¼‰åœ¨éƒ¨ç½²ä¹‹å‰éƒ½è¦ç¶“éå»ºç½®ï¼ˆ`build`ï¼‰ï¼Ÿ
  </summary>
  å› ç‚ºç€è¦½å™¨ç„¡æ³•ç›´æ¥è®€å–æˆ‘å€‘çš„ ESM å’Œ ES10 ä»£ç¢¼ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦ webpack åœ¨å»ºç½®éç¨‹ä¸­å¹«åŠ©æˆ‘å€‘æ‰“åŒ…ä»£ç¢¼ã€‚
</details>

<details>
  <summary>
    2. <code>require/module.exports</code> èˆ‡ <code>import/export</code>{" "}
    æœ‰ä»€éº¼ä¸åŒï¼Ÿ
  </summary>
  <code>require/module.exports</code> æ˜¯æ”¯æ´ Node.js çš„ CommonJS èªæ³•ï¼Œè€Œ <code>
    import/export
  </code> æ˜¯ ES6 çš„èªæ³•ï¼Œç”± Node.js å’Œéƒ¨åˆ†ç€è¦½å™¨æ”¯æ´ã€‚
</details>

<details>
  <summary>
    3. åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ ES6 çš„ <code>import/export</code> æœ‰ä»€éº¼é™åˆ¶å—ï¼Ÿ
  </summary>
  <ol style={{ listStyleType: "decimal" }}>
    <li>å¿…é ˆåœ¨ server ç«¯åŸ·è¡Œ</li>
    <li>
      å¿…é ˆåœ¨ <code>&lt;script&gt;</code> æ¨™ç±¤ä¸­åŠ ä¸Š <code>type=module</code>
    </li>
    <li>
      å¿…é ˆåœ¨ <code>import</code> ä¸­æŒ‡å®šæª”æ¡ˆå‰¯æª”å
    </li>
    <li>
      å¿…é ˆåœ¨ <code>import</code> ä¸­æŒ‡å®š npm å¥—ä»¶çš„çµ•å°è·¯å¾‘
    </li>
  </ol>
</details>

<details>
  <summary>
    4. ç‚ºä»€éº¼æˆ‘å€‘è¦ä½¿ç”¨ <code>webpack</code>ï¼Ÿ
  </summary>
  <ol style={{ listStyleType: "decimal" }}>
    <li>æˆ‘å€‘æƒ³æ›´å®¹æ˜“åœ°å¼•å…¥ ES6 æ¨¡çµ„ï¼ˆå’Œ npm å¥—ä»¶ï¼‰</li>
    <li>æˆ‘å€‘æƒ³æ›´å®¹æ˜“åœ°å¼•å…¥åœ–ç‰‡å’Œ CSS æª”æ¡ˆ</li>
    <li>æˆ‘å€‘æƒ³çµ±ä¸€åœ¨ä¸€å€‹åœ°æ–¹è™•ç† uglifyã€minify å’Œå…¶ä»–è™•ç†ç¨‹åº</li>
  </ol>
</details>

<details>
  <summary>
    5. ç‚ºä»€éº¼ <code>webpack</code> éœ€è¦ <code>loader</code>ï¼Ÿ
  </summary>
  Webpack é è¨­çš„ loader åªèƒ½è®€å– JavaScriptï¼Œä½†æ˜¯å…¶ä»–çš„ loader å¯ä»¥è®€å– CSSã€åœ–ç‰‡ç­‰ç­‰ã€‚
</details>
